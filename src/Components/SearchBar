import React, { Component }     from 'react';
import {AutoComplete}           from 'material-ui'
import getMuiTheme              from 'material-ui/styles/getMuiTheme';
import MuiThemeProvider         from 'material-ui/styles/MuiThemeProvider';
import injectTapEventPlugin     from 'react-tap-event-plugin';
import _                        from 'lodash';
injectTapEventPlugin();

class SearchBar extends Component {

    spotifyApi = new SpotifyWebApi({
    accessToken: 'BQD-TLAY2lCpg7442trgtRj3x1W26ar_J4th_EdScmERMd9-dFjqhTEibMhir6Cg6j8iG0oIW70Ec8T_KUOFzw'
    });

    constructor(props) {
        super(props);

        this.state = {
            data: [],
        };
    }

    handleUpdateInput(value) {
        this.spotifyApi.searchArtists(value).then((data) => {
            console.log(`Search for ${query}`, data);
            var results = _.map(data.body.artists.items, (artist) => {
                return artist.name;
            });

            this.setState({
                data: results
            });
        }, function (err) {
            console.error(err);
        });
    }

    render() {
        return <MuiThemeProvider muiTheme={getMuiTheme()}>
            <AutoComplete
                dataSource    = {this.state.data}
                onUpdateInput = {this.handleUpdateInput}
                fullWidth={true} />
        </MuiThemeProvider>;
    }

}

export default SearchBar;